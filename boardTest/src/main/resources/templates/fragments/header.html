<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>header</title>
</head>
<body>
<header th:fragment="siteHeader(active)" class="site-header">
    <div class="wrap site-header__bar">

        <!-- 좌측: 로고 -->
        <a href="/" th:text="#{app.title}" class="brand">MoodTrip</a>

        <!-- 중앙: 네비 -->
        <nav class="nav">
            <a href="/trips"   th:classappend="${active}=='trips' ? ' active'"   th:text="#{nav.trips}">여행</a>
            <a href="/places"  th:classappend="${active}=='places' ? ' active'"  th:text="#{nav.places}">맛집</a>
            <a href="/reviews" th:classappend="${active}=='reviews' ? ' active'" th:text="#{nav.reviews}">리뷰</a>
            <a href="/coming-soon" th:text="#{nav.videos}">영상</a>
            <a href="/coming-soon" th:text="#{nav.products}">용품</a>
        </nav>

        <!-- 우측: 로그인/언어 -->
        <div class="header-ops">
      <span th:if="${session.LOGIN_USER == null}">
        <a href="/login"  th:text="#{auth.login}">로그인</a>
        <a href="/signup" th:text="#{auth.signup}">회원가입</a>
      </span>
            <span th:if="${session.LOGIN_USER != null}">
        <form th:action="@{/logout}" method="post" style="display:inline">
          <button type="submit" class="btn btn-primary" th:text="#{auth.logout}">로그아웃</button>
        </form>
      </span>

            <div class="lang-dropdown">
                <button class="lang-toggle">
                    🌐 <span th:text="${#locale.language?.toUpperCase()}">KO</span> ▼
                </button>
                <div class="lang-menu">
                    <a th:href="@{?lang=ko}" th:classappend="${#locale.language=='ko'} ? 'active'">KO</a>
                    <a th:href="@{?lang=en}" th:classappend="${#locale.language=='en'} ? 'active'">EN</a>
                    <a th:href="@{?lang=uk}" th:classappend="${#locale.language=='uk'} ? 'active'">UK</a>
                </div>
            </div>
        </div>
    </div>

    <div th:if="${param.loggedOut}" class="wrap msg">
        정상적으로 로그아웃되었습니다.
    </div>
</header>

    <style>
        header a { color:#333; text-decoration:none; padding:6px 8px; border-radius:6px }
        header a.active { background:#1976d2; color:#fff }
        header button { background:#1976d2; color:#fff; border:none; border-radius:6px; padding:6px 10px; cursor:pointer }

        /* 언어 드롭다운 */
        .lang-dropdown {
          position:relative;
          display:inline-block; /* hover 범위 안정화 */
        }
        .lang-toggle {
          background:transparent;
          border:1px solid #ddd;
          border-radius:6px;
          padding:4px 8px;
          font-size:12px;
          cursor:pointer;
          color:#444;
          line-height:1;           /* 라인박스 여백 최소화 */
        }
        .lang-toggle:hover { background:#f8f9fa; }

        .lang-menu {
          position:absolute;
          right:0;
          top:100%;                /* 버튼 바로 아래에 ‘밀착’ */
          margin-top:0;            /* 간격 제거 */
          background:#fff;
          border:1px solid #ddd;
          border-radius:6px;
          box-shadow:0 4px 10px rgba(0,0,0,.08);
          z-index:10;
          min-width:70px;

          /* 초기엔 숨김 + 슬라이드다운 애니메이션 준비 */
          display:block;           /* 트랜지션 위해 block 유지 */
          opacity:0;
          visibility:hidden;
          transform:translateY(-6px) scaleY(.98);
          transform-origin:top;
          transition:
            opacity .18s ease,
            transform .18s ease,
            visibility 0s linear .18s; /* 닫힐 때만 지연 */
        }
        .lang-menu a {
          display:block;
          padding:6px 10px;
          font-size:12px;
          color:#333;
          text-decoration:none;
          white-space:nowrap;
        }
        .lang-menu a:hover { background:#f1f5f9; }
        .lang-menu a.active { background:#1976d2; color:#fff; }

        /* hover 또는 키보드 포커스로 열기 */
        .lang-dropdown:hover .lang-menu,
        .lang-dropdown:focus-within .lang-menu {
          opacity:1;
          visibility:visible;
          transform:translateY(0) scaleY(1);
          transition:
            opacity .18s ease,
            transform .18s ease,
            visibility 0s; /* 열릴 때 즉시 보이기 */
        }

        /* 혹시 모를 1~2px 끊김 방지용(투명 히트존) - 필요 없으면 제거해도 됨 */
        .lang-dropdown::after {
          content:"";
          position:absolute;
          left:0; right:0;
          top:100%;
          height:2px;              /* 시각적 공간은 0, hover만 이어줌 */
        }
    </style>
</header>
</body>
</html>
